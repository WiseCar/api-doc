# 行车轨迹

## 1. 创建新轨迹记录
当车辆在行驶中时, 对车辆行驶轨迹进行记录。

### URL
`POST /api/mobile/track`

### 返回数据
1. 请求成功

    ```
    {
        "status": 'success',
        "trackId": 1 /*本次轨迹记录编号*/
    }
    ```

2. 没有车辆行驶数据

    ```
    {
        "status": "failed",
        "errorNo": "ILLEGAL_REQUEST",
        "error": "没有车辆行驶数据。 请确定车辆正在行驶中, 车载设备收发数据正常。"
    }
    ```

## 2. 刷新轨迹数据
获取到轨迹记录编号后, 可以每分钟向服务器请求一次.

### URL
`POST /api/mobile/track/{id}`

### 请求参数

| 参数名称 | 说明 | 是否必须 | 举例 |
| -------- | ---- | -------- | ---- |
| id | URL模板参数, 轨迹记录ID | 是 | 1 |

### 返回数据
1. 请求成功

    ```
    {
        "status": "success",
        "count": 2,
        "locations": [
            {
                "id": 791203,
                "obdCode": "incar-obd-1314",
                "tripId": 904,
                "vid": null,
                "vin": null,
                "locationSpeed": 12,
                "travelDistance": 8224,
                "longitude": "E113.912469",
                "latitude": "N22.509596",
                "direction": 99,
                "locationTime": "2016-05-02 12:12:00",
                "locationType": 2,
                "recordTime": "2016-05-02 14:20:00",
                "rowNo": 1
            },
            {
                "id": 791204,
                "obdCode": "incar-obd-1314",
                "tripId": 904,
                "vid": null,
                "vin": null,
                "locationSpeed": 35,
                "travelDistance": 9024,
                "longitude": "E113.912014",
                "latitude": "N22.509740",
                "direction": 90,
                "locationTime": "2016-05-02 12:23:00",
                "locationType": 2,
                "recordTime": "2016-05-02 14:20:00",
                "rowNo": 2
            }
        ]
    }
    ```

2. 没有指定的轨迹信息

    ```
    {
        "status": "failed",
        "errorNo": "NO_RECORD",
        "error": "没有指定的轨迹信息"
    }
    ```

## 3. 获取轨迹历史记录
### URL
`GET /api/mobile/track`

### 请求参数

| 参数名称 | 说明 | 是否必须 | 举例 |
| -------- | ---- | -------- | ---- |
| pageSize | 每页条数, 默认20 | 否 | 20 |
| nextMarker | 起始条目序号, 默认1. 假定请求第N页数据, 则 `nextMarker = ((N-1)*pageSize)+1` | 否 | 1 |

### 返回数据

```
{
    "status": "success",
    "count": 2,
    "total": 22,
    "tracks": [{
        "id": 1, /* 行车轨迹编号 */
        "obd_code": "incar-obd-12345",
        "trip_id": 1, /* 行程编号 */
        "start": "2014-06-22 16:00:00", /* 开始记录时间 */
        "end": "2014-06-22 16:20:00" /* 结束记录时间, 以最后一次刷新轨迹地图时间作为记录终止时间 */
    }, {
        "id": 2,
        "obd_code": "incar-obd-12345",
        "trip_id": 1,
        "start": "2014-06-23 16:00:00",
        "end": "2014-06-23 16:20:00"
    }]
}
```
